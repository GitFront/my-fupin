function initOption(e,a,o,l,t){return{title:!1,mapName:a,height:"550",authInfo:{userPac:o,userLevel:l},fontFamily:"Microsoft YaHei",topNode:e,isLayerLoad:!0,color:{backgroundColor:"#1f1e30",borderColor:"#1d1a29",seriesNullColor:"#56627c",seriesBorderColor:"#212832",seriesSelectColor:"#f3e924",dataLabelColor:"#FFF",tooltipNameColor:"#f3e924",tooltipValueColor:"#f3e924",tooltipMinorValueColor:"#FFFFFF",tooltipBackgroundColor:"#1d1a28",tooltipBorderColor:"#76d1fd"},pointLoader:{isLoadPoint:!0,isRemote:!0,doSetPoint:"showpoint"},mapLoader:{isRemote:!1,isDomain:!1,jsonpCallback:"mapGeoJsonp",localUrl:t},showPoint:!0,colorStops:badColor,legend:{enabled:!0,legendFloat:!0,legendAlign:"bottom",backgroundColor:"rgba(29,26,40,0.7)",x:-95,y:-25},drillUpButton:{relativeTo:"spacingBox",y:20,x:-60,fill:"#6cc3ed",strokeWidth:1,stroke:"#87e6fa",r:3,fontColor:"#1c1925",fontSize:13,selectColor:"#3bb0c9"},navigation:!0,navigationButton:!1,valueDecimal:2,parentKey:"PPAC",drillKey:"drillKey",valueMapper:[{key:"value",name:"贫困人数",valueSuffix:"人"},{key:"value2",name:"预脱贫人数",valueSuffix:"人"},{key:"value3",name:"预脱贫率（按人数）",valueSuffix:"%"}],doClick:"re",doDrilldown:"changeData",doDrillup:"fan",setLoading:["showLoadingMask","closeLoading"]}}function getDate(){return $.ajax({type:"post",url:ctx+"/a/map/mapDate",dataType:"json"})}function changeDataMapDataType(e){type=e,loadMap(e,scope)}function loadMap(e,a){var o={},l={},t=[];1==e?(o=[{key:"value",name:"贫困户数",valueSuffix:"户"},{key:"value2",name:"预脱贫户数",valueSuffix:"户"},{key:"value3",name:"预脱贫户比例",valueSuffix:"%"}],l={key:"PAC",value:"POOR_FAM",value2:"AID_POOR_FAM",value3:"AID_POOR_FAM_R"},t=badColor):5==e?(o=[{key:"value",name:"预脱贫户比例",valueSuffix:"%"},{key:"value2",name:"预脱贫户数",valueSuffix:"户"},{key:"value3",name:"贫困户数",valueSuffix:"户"}],l={key:"PAC",value:"AID_POOR_FAM_R",value2:"AID_POOR_FAM",value3:"POOR_POP"},t=greatColor):3==e?(o=[{key:"value",name:"预脱贫户数",valueSuffix:"户"},{key:"value2",name:"贫困户数",valueSuffix:"户"},{key:"value3",name:"预脱贫户比例",valueSuffix:"%"}],l={key:"PAC",value:"AID_POOR_FAM",value2:"POOR_FAM",value3:"AID_POOR_FAM_R"},t=greatColor):4==e?(o=[{key:"value",name:"预脱贫人数",valueSuffix:"人"},{key:"value2",name:"贫困人数",valueSuffix:"人"},{key:"value3",name:"预脱贫率（按人数）",valueSuffix:"%"}],l={key:"PAC",value:"AID_POOR_POP",value2:"POOR_POP",value3:"AID_POOR_POP_R"},t=greatColor):2==e?(o=[{key:"value",name:"贫困人数",valueSuffix:"人"},{key:"value2",name:"预脱贫人数",valueSuffix:"人"},{key:"value3",name:"预脱贫率（按人数）",valueSuffix:"%"}],l={key:"PAC",value:"POOR_POP",value2:"AID_POOR_POP",value3:"AID_POOR_POP_R"},t=badColor):6==e&&(o=[{key:"value",name:"预脱贫率（按人数）",valueSuffix:"%"},{key:"value2",name:"贫困人数",valueSuffix:"人"},{key:"value3",name:"预脱贫人数",valueSuffix:"人"}],l={key:"PAC",value:"AID_POOR_POP_R",value2:"POOR_POP",value3:"AID_POOR_POP"},t=greatColor),Highmap.mybatis.reloadData(Highmap.mapid,queryName,{type:e,scope:a,newDate:statTime,helppac:helppac},l,o,t)}function changeDataMapDataScope(e){Highmap.levelid;loadMap(type,scope=e)}function re(e){var a=e.properties.PAC,o=(e.properties.name,e.properties.type);"PKH"==o&&$.poorFile.showFamilyFile(a),"PKC"==o&&$.poorFile.showCountryFile(a)}function test(){alert(1)}function changeData(e,a,o){$.ajax({type:"POST",url:ctx+"/a/map/mapPac",dataType:"json",data:{pacid:a,level:o},success:function(e){var a=e.pac,l={hasCountryFile:!0};loading_api=changeDataDistrict(levelMap.get(o),a,l)}})}function showpoint(e,a){var o={};if(a<5){o.isLoadPoint=!0,o.isRemote=!0;var l=2;a>1&&(l=3);i={queryName:"aspire.bi.common.povertygeometry.queryMappiontGeoForCountry",mapper:{name:"NAME",PAC:"PAC",PPAC:"PPAC",longitude:"LONGITUDE",latitude:"LATITUDE",type:"POINT_TYPE"},pointName:"相对贫困村",pointVisible:!1,pointColor:"#ffff32",radius:l};o.points=[i]}else{o.isLoadPoint=!0,o.isRemote=!0;var t={name:"NAME",PAC:"PAC",PPAC:"PPAC",longitude:"LONGITUDE",latitude:"LATITUDE",type:"POINT_TYPE"},i={queryName:"aspire.bi.common.povertygeometry.queryMappiontGeoForFam",parameters:{isOut:1},mapper:t,pointName:"预脱贫户",pointVisible:!0,pointColor:"#009311",radius:l=3.5},n={queryName:"aspire.bi.common.povertygeometry.queryMappiontGeoForFam",parameters:{isOut:0},mapper:t,pointName:"未脱贫户",pointVisible:!0,pointColor:"#ffff32",radius:l};o.points=[i,n]}return o}function fan(e,a){showLoadingMask(),$.ajax({type:"POST",url:ctx+"/a/map/mapPac",dataType:"json",data:{pacid:e,level:a},success:function(e){var o=e.pac,l={hasCountryFile:!1};loading_api=changeDataDistrict(levelMap.get(a),o,l),closeLoading()},error:function(e){loading_api.onError()}})}function closeLoading(){waitLoad?loading_api.onSuccess():waitLoad=setInterval(function(){var e=!1;null!==loading_api&&(e=!0),e&&(loading_api.onSuccess(),clearInterval(waitLoad))},20)}function dataMapBack(){Highmap.mapObject.drillUp()}var loading_api=null,badColor=["#91d4ff","#2e5fff","#ff0000"],greatColor=["#91d4ff","#2e5fff","#6bdb1f"],levelMap=new Map;levelMap.put(1,"province"),levelMap.put(2,"city"),levelMap.put(3,"county"),levelMap.put(4,"town"),levelMap.put(5,"country");var type=1,scope="1",statTime="",helppac="999",queryName="com.aspire.birp.modules.antiPoverty.dao.DataMonDao.queryMapCun";$(function(){var e=getDate();e&&e.then(function(e){var a=initOption(e.mapPac,e.mapName,e.userPac,e.userLevel,e.geoPath);statTime=e.statTime,helppac=e.helppac,Highmap.mybatis.Map("map",queryName,{type:type,scope:scope,newDate:statTime,helppac:helppac},{key:"PAC",value:"POOR_POP",value2:"AID_POOR_POP",value3:"AID_POOR_POP_R"},"PAC:"+e.mapPac,"PAC",a),changeData(null,e.userPac,e.userLevel)})});var waitLoad=null;