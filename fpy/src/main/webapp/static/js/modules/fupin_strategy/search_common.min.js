function goSearchResult(e,t){location.href="search_result.html?id="+e+"&type="+t}var SEARCH_TYPES={FAMILY:"family",COUNTRY:"country",HELPER:"helper",PROJECT:"project"};$(function(){function e(e){var a=k.find("li.hover");switch(e.keyCode){case 38:if(a.length>0){var n=a.removeClass(f).prev();n.length>0&&n.addClass(f)}else k.find("li:last").addClass(f);break;case 40:if(a.length>0){var r=a.removeClass("hover").next();r.length>0&&r.addClass(f)}else k.find("li:first").addClass(f);break;case 13:t(a);break;default:var l=P.val();l!=i&&m(d(l))}i=P.val()}function t(e){e&&e.length>0&&goSearchResult(s=e.attr("data-id"),n())}function a(){P.val("")[0].focus(),l()}function n(){return y.val()}function r(e){var t=e.result,a=e.keyword;if(t.length<=0)l();else if(P.val()){k.html(template("tplPreSearch",{keyword:a,result:t})).show();var n=k.find("li");n.hover(function(){n.removeClass(f),$(this).addClass(f)},function(){$(this).removeClass(f)})}else l()}function l(){k.html("").hide()}var i,s,o="click",c="input",u="change",h="keyup",p="open",f="hover",d=$.trim,v=($.extend,Helpers.ajax),m=function(e,t){var a;return function(){var n=Array.prototype.slice.apply(arguments);a&&(clearTimeout(a),a=null),a=setTimeout(function(){e.apply(this,n),a=null},t)}}(function(e){v({url:URLS.URL_SEARCH_PRE_SEARCH,data:{key:e,type:n()},suppressNetErr:!0,success:function(e){var t=e.code,a=e.data;0==t&&a&&r(a)}})},300),C=$("body"),g=$("#navSearch"),y=$("#selectPresearchTypes"),P=$("#inputPresearchField"),R=$("#btnClearPresearch"),S=$("#presearchWrapper"),k=$("#searchsSuggest");g.on(o,function(e){e.stopPropagation(),g.toggleClass(p)}),R.on(o,a),y.on(u,function(){a()}).selectbox(),P.on(c,function(){""!==P.val()?R.show():R.hide()}).on(h,e),S.on(o,function(e){e.stopPropagation()}),C.on(o,function(){g.removeClass(p),l()}),k.on(o,"li",function(){t($(this))}),C.append(['<script id="tplPreSearch" type="text/html">',"<ul>","<#for(var i = 0, len = result.length; i < len; i++){#>","<#var item = result[i];#>",'<li data-id="<#=item.id#>"><#=item.name#><span> - <#=item.place#></span></li>',"<#}#>","</ul>","<\/script>"].join(""))});