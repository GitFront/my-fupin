$.namespace("common.report.echarts"),Array.prototype.contains=function(e){for(var t=this.length;t--;)if(this[t]===e)return!0;return!1};var Echart={ChartDataFormate:{FormateNOGroupData:function(e){common.utils.isArray(e)||(e=[]);for(var t=[],a=[],o=0;o<e.length;o++)t.push(e[o].name||""),a.push(e[o]);return{category:t,data:a}},FormatGroupData:function(e){common.utils.isArray(e)||(e=[]);for(var t=new Array,a=new Array,o=new Array,r=0;r<e.length;r++)t.contains(e[r].name)||t.push(e[r].name),a.contains(e[r].group)||a.push(e[r].group);for(r=0;r<a.length;r++){for(var i={},l=a[r],n=new Array,s=0;s<e.length;s++)for(var c=0;c<t.length;c++)a[r]==e[s].group&&e[s].name==t[c]&&n.push(e[s].value);i={name:l,data:n,visible:!0},o.push(i)}return{category:t,groups:a,series:o}},FormatGroupTypeData:function(e){common.utils.isArray(e)||(e=[]);for(var t=new Array,a=new Array,o=new Array,r=0;r<e.length;r++)t.contains(e[r].name)||t.push(e[r].name),a.contains(e[r].group)||a.push(e[r].group);for(r=0;r<a.length;r++){for(var i,l={},n=a[r],s=new Array,c=0;c<t.length;c++)for(var u=0;u<e.length;u++)a[r]==e[u].group&&e[u].name==t[c]&&(s.push(e[u].value),i=e[u].type);l={name:n,data:s,visible:!0,type:i},o.push(l)}return{category:t,groups:a,series:o}},FormatScatterMapData:function(e){var t=[];return $.each(e,function(e,a){var o=a.for,r=a.to,i=[];$.each(r,function(e,t){i.push({name:t.name,fromName:o.name,coords:[o.coords,t.coords],value:t.coords.concat(t.value)})}),i.push({name:o.name,fromName:o.name,coords:[o.coords,o.coords],value:o.coords.concat(o.value)}),t.push(i)}),t}},ChartOptionTemplates:{Pie:function(e,t){var a=Echart.ChartDataFormate.FormateNOGroupData(e),o=Echart.utils.createSeries(a.data,t,"Pie"),r={backgroundColor:t.backgroundColor,color:t.color,title:{text:t.title},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{show:t.isLegend,data:a.groups},visualMap:"",series:o};return t.isVisualMap&&(r.visualMap={show:!1,min:t.visualMap_min,max:Echart.utils.getSumValue(e),inRange:{colorLightness:[.45,1]}}),r},RPie:function(e,t){var a=Echart.ChartDataFormate.FormateNOGroupData(e),o=Echart.utils.createSeries(a.data,t,"RPie"),r={backgroundColor:t.backgroundColor,title:{text:t.title},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{show:t.isLegend,data:a.groups},visualMap:"",series:o};return t.isVisualMap&&(r.visualMap={show:!1,min:t.visualMap_min,max:Echart.utils.getSumValue(e),inRange:{colorLightness:[.45,1]}}),r},Bars:function(e,t){var a=Echart.ChartDataFormate.FormatGroupTypeData(e),o=Echart.utils.createSeries(a.series,t,"Bars"),r={backgroundColor:t.backgroundColor,color:t.color,barGap:t.barGap,barCategoryGap:t.barCategoryGap,title:{text:t.title},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:t.isLegend,data:a.groups,textStyle:{color:"#fff"},x:t.legendX,y:t.legendY,itemHeight:t.legendItemHeight,itemWidth:t.legendItemWidth},grid:{left:t.grid_left,right:t.grid_right,bottom:t.grid_bottom,top:t.grid_top,containLabel:!0},xAxis:{type:"category",data:a.category,splitLine:{show:t.xAxis_sline_show,lineStyle:{color:t.xAxis_sline_color}},axisLabel:{textStyle:{color:t.xAxis_label_color}},axisLine:{lineStyle:{color:t.xAxis_line_color}}},yAxis:[{type:"value",splitLine:{show:t.yAxis_sline_show,lineStyle:{color:t.yAxis_sline_color}},axisLabel:{textStyle:{color:t.yAxis_label_color}},axisLine:{lineStyle:{color:t.yAxis_line_color}}}],series:o};if(t.enable2y){var i="{value}";t.line_percent&&(i="{value}%"),r.yAxis.push({type:"value",min:0,max:null,splitLine:{show:t.yAxis_sline_show,lineStyle:{color:t.yAxis_sline_color}},axisLabel:{formatter:i,textStyle:{color:t.yAxis_label_color}},axisLine:{lineStyle:{color:t.yAxis_line_color}}})}if(t.exchangeXY){var l=r.xAxis,n=r.yAxis;r.xAxis=n,r.yAxis=l}return r},Line:function(e,t){var a=Echart.ChartDataFormate.FormatGroupData(e),o=Echart.utils.createSeries(a.series,t,"Line"),r={backgroundColor:t.backgroundColor,color:t.color,title:{text:t.title},tooltip:{trigger:"axis"},legend:{show:t.isLegend,data:a.groups},grid:{left:t.grid_left,right:t.grid_right,bottom:t.grid_bottom,top:t.grid_top,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:a.category,splitLine:{lineStyle:{color:t.xAxis_sline_color}},axisLabel:{textStyle:{color:t.xAxis_label_color}},axisLine:{lineStyle:{color:t.xAxis_line_color}}},yAxis:{type:"value",splitLine:{lineStyle:{color:t.yAxis_sline_color}},axisLabel:{textStyle:{color:t.yAxis_label_color}},axisLine:{lineStyle:{color:t.yAxis_line_color}}},series:o};if(t.exchangeXY){var i=r.xAxis,l=r.yAxis;r.xAxis=l,r.yAxis=i}return r},Gauge:function(e,t){var a=Echart.ChartDataFormate.FormateNOGroupData(e),o=Echart.utils.createSeries(a.data,t,"Gauge");return{backgroundColor:t.backgroundColor,title:{text:t.title},tooltip:{formatter:"{a}</br> {b}: {c}%"},series:o}},Statter:function(e,t){var a=Echart.ChartDataFormate.FormatGroupData(e),o=Echart.utils.createSeries(a.series,t,"Statter");return{color:t.color,backgroundColor:t.backgroundColor,title:{text:t.title},legend:{show:t.isLegend,data:a.groups},visualMap:[{show:!1,dimension:2,max:Echart.utils.getMaxValue(e),inRange:{symbolSize:[10,40]}}],tooltip:{padding:5,backgroundColor:"#222",borderColor:"#777",borderWidth:1,formatter:function(e){var a=t.schema,o=e.seriesName+"<br>";return $.each(e.value,function(e,t){o+=1==e?a[e]+" : "+t+"%<br>":a[e]+" : "+t+"<br>"}),o}},grid:{left:t.grid_left,right:t.grid_right,bottom:t.grid_bottom,top:t.grid_top,containLabel:!0},xAxis:{name:t.xAxisName,nameTextStyle:{color:t.xAxis_text_color},splitLine:{lineStyle:{color:t.xAxis_sline_color,type:"dashed"}},axisLabel:{textStyle:{color:t.xAxis_label_color}},axisLine:{lineStyle:{color:t.xAxis_line_color}}},yAxis:{name:t.yAxisName,nameTextStyle:{color:t.yAxis_text_color},splitLine:{lineStyle:{color:t.yAxis_sline_color,type:"dashed"}},axisLabel:{formatter:"{value}%",textStyle:{color:t.yAxis_label_color}},axisLine:{lineStyle:{color:t.yAxis_line_color}},scale:!0},series:o}},StatterMap:function(e,t){var a=Echart.ChartDataFormate.FormatScatterMapData(e),o=Echart.utils.createSeries(a,t,"StatterMap");return{backgroundColor:t.backgroundColor,tooltip:{trigger:"item",formatter:function(e,a,o){var r=e.data;if(void 0==r.value||void 0==r.value[3])return null;var i=r.name+"<br/>";return $.each(r.value,function(e,a){e>1&&(i+=t.schema[e-2]+" : "+a+"<br/>")}),i}},visualMap:[{show:!1,dimension:2,max:180494,inRange:{symbolSize:[15,32]}}],geo:{selectedMode:"single",label:{emphasis:{show:!1}},map:t.mapName,roam:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#252d35",shadowColor:"rgba(0, 0, 0, 0.5)",shadowBlur:.5},emphasis:{areaColor:"#2a333d"}}},series:o}}},create:{init:function(container,data,option,type){var option_=Echart.utils.defaultOption(option);option_.container=container,option_.optionType=type;var opt=eval("Echart.ChartOptionTemplates."+type+"(data,option_)"),chart=echarts.init(document.getElementById(container));chart.setOption(opt);var obj={chart:chart,chartType:type,option:option_,data:data},id=common.report.highcharts.object.add(obj);return id},Pie:function(e,t,a){return this.init(e,t,a,"Pie")},RPie:function(e,t,a){return this.init(e,t,a,"Pie")},Bars:function(e,t,a){return this.init(e,t,a,"Bars")},Line:function(e,t,a){return this.init(e,t,a,"Line")},Gauge:function(e,t,a){return this.init(e,t,a,"Gauge")},Statter:function(e,t,a){return this.init(e,t,a,"Statter")},StatterMap:function(e,t,a){var o=a.url,r=o.slice(o.lastIndexOf("/")+1,o.lastIndexOf(".")),i=this;return $.get(o,function(o){return echarts.registerMap(r,o),a.mapName=r,i.init(e,t,a,"StatterMap")}),null}},reload:function(e,t,a,o){},remove:function(e){},utils:{defaultOption:function(e){var t={color:["#7ddc79","#fffa7d","#ffaf60","#7d7dff","#ea97ff","#d156ff","#2f7dff","#2faaff","#6dc3ff","#88e7fb"],title:"",backgroundColor:"",valueName:"数值",valueName2:"数值",radius:"55%",radius2:[0,"30%"],pie_center:["50%","50%"],pie_item_color:"",pie_label_color:"#fff",pie_label_color2:"#fff",pie_line_color:"#fff",pie_label_show:!0,pie_label_show2:!0,nest:!1,line_width:4,visualMap_min:80,visualMap_max:600,barCategoryGap:"40%",pie_roseType:"",isLegend:!1,legendX:"center",legendY:"bottom",legendItemWidth:25,legendItemHeight:14,exchangeXY:!1,bar_stack:!1,gauge_center:[["50%","50%"]],gauge_title_color:"#9ED9E1",gauge_item_color:"#95ffff",gauge_detail_color:"#fff",gauge_split_color:"#96b5ff",gauge_axis_color:"#96b5ff",gauge_split_width:2,gauge_line_width:2,gauge_axis_show:!0,gauge_splitNumber:10,gauge_max:100,line_percent:!0,gauge_line_color:[[[.2,"#91c7ae"],[.8,"#ff1652"],[1,"#f0e126"]]],schema:[],yAxisName:"",yAxis_sline_color:"#404068",yAxis_line_color:"#a0c0ff",yAxis_label_color:"#fff",yAxis_text_color:"#fff",enable2y:!1,yAxis_sline_show:!0,xAxisName:"",xAxis_sline_color:"#404068",xAxis_line_color:"#a0c0ff",xAxis_label_color:"#fff",xAxis_text_color:"#fff",xAxis_sline_show:!0,grid_left:"4%",grid_right:"4%",grid_bottom:"4%",grid_top:"4%",isVisualMap:!1,label_position:"top",mapName:"",doClick:"",doLoad:""};return common.utils.setDefaultOption(e,t)},getOption:function(data,option,type){var option_=Echart.utils.defaultOption(option),opt=eval("Echart.ChartOptionTemplates."+type+"(data,option_)");return opt},createSeries:function(e,t,a){var o={};switch(a){case"Pie":r=e;t.nest||((r=[])[0]=e),(o=[]).push({name:t.valueName,type:"pie",radius:t.radius,center:t.pie_center,data:r[0].sort(function(e,t){return e.value-t.value}),roseType:t.pie_roseType,label:{normal:{show:t.pie_label_show,textStyle:{color:t.pie_label_color}}},labelLine:{normal:{show:!0,lineStyle:{color:t.pie_line_color}}},itemStyle:{normal:{color:t.pie_item_color},emphasis:{shadowBlur:20,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}),t.nest&&(r[1][0].selected=!0,o.push({name:t.valueName2,type:"pie",selectedMode:"single",radius:t.radius2,label:{normal:{position:"inner",show:t.pie_label_show2,textStyle:{color:t.pie_label_color2}}},labelLine:{normal:{show:!1}},data:r[1].sort(function(e,t){return e.value-t.value})}));break;case"RPie":var r=e;t.nest||((r=[])[0]=e),(o=[]).push({name:t.valueName,type:"pie",radius:t.radius,center:t.pie_center,color:["#6bdb1f","#739ffa","#30507a"],data:r[0],roseType:t.pie_roseType,label:{normal:{show:t.pie_label_show,textStyle:{color:t.pie_label_color}}},labelLine:{normal:{show:!0,lineStyle:{color:t.pie_line_color}}},itemStyle:{emphasis:{shadowBlur:20,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}),t.nest&&(r[1][0].selected=!0,o.push({name:t.valueName2,type:"pie",selectedMode:"single",radius:t.radius2,label:{normal:{position:"inner",show:t.pie_label_show2,textStyle:{color:t.pie_label_color2}}},labelLine:{normal:{show:!1}},itemStyle:{emphasis:{shadowBlur:20,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},data:r[1].sort(function(e,t){return e.value-t.value})}));break;case"Bars":o=[],$.each(e,function(e,a){var r="line"!=a.type,i=t.bar_label_show;"line"==a.type&&(i=!1);var l={name:a.name,type:null==a.type?"bar":a.type,clockwise:!1,stack:t.bar_stack,symbol:"",symbolSize:0,smooth:!0,yAxisIndex:1==r?0:1,label:{normal:{show:i,position:t.label_position}},lineStyle:{normal:{width:t.line_width}},data:a.data};o.push(l)});break;case"Line":o=[],$.each(e,function(e,t){var a={name:t.name,type:"line",stack:!0,smooth:!0,data:t.data};o.push(a)});break;case"Gauge":o=[],$.each(e,function(e,a){var r={name:t.valueName,type:"gauge",min:0,max:t.gauge_max,splitNumber:t.gauge_splitNumber,center:t.gauge_center[e],radius:t.radius,axisLine:{lineStyle:{color:t.gauge_line_color[e],width:t.gauge_line_width}},axisLabel:{show:t.gauge_axis_show,textStyle:{color:t.gauge_axis_color}},axisTick:{length:7,lineStyle:{color:"auto"}},splitLine:{length:10,lineStyle:{width:t.gauge_split_width,color:t.gauge_split_color}},pointer:{width:5},title:{offsetCenter:[0,"90%"],textStyle:{fontSize:13,color:t.gauge_title_color}},itemStyle:{normal:{color:t.gauge_item_color}},detail:{show:!0,offsetCenter:[0,"25%"],formatter:"{value}%",textStyle:{fontSize:18,fontWeight:"bolder",color:t.gauge_detail_color}},data:a};o.push(r)});break;case"Statter":o=[],e=e.sort(function(e,t){return e.data[0][e.data[0].length-1]-t.data[0][t.data[0].length-1]}).reverse(),$.each(e,function(e,t){var a={name:t.name,data:t.data,type:"scatter"};o.push(a)});break;case"StatterMap":o=[],$.each(e,function(e,t){o.push({name:t.name,type:"lines",zlevel:1,effect:{show:!0,period:6,trailLength:.7,color:"#F4E925",symbolSize:3},lineStyle:{normal:{color:"#F4E925",width:0,curveness:.2}},data:t},{name:t.name,type:"lines",zlevel:2,effect:{show:!0,period:6,trailLength:0,symbolSize:0},lineStyle:{normal:{color:"#F4E925",width:1,opacity:.4,curveness:.2}},data:t},{name:t.name,type:"effectScatter",coordinateSystem:"geo",zlevel:2,rippleEffect:{brushType:"stroke"},label:{normal:{show:!0,position:"right",formatter:"{b}"}},itemStyle:{normal:{color:"#F4E925"}},data:t})})}return o},getSumValue:function(e){var t=0;return $.each(e,function(e,a){t+=a.value}),t},getMaxValue:function(e,t){var a=0;return $.each(e,function(e,t){t.value[2]>a&&(a=t.value[2])}),a},sort:function(e){}}};