function getCheckedSearchType(){return $(".search-type:checked").val()}$(function(){var e,a="click",t=($.extend,Helpers.ajax),r=$("body"),n=$("#searchField");$("#btnSearch").on(a,function(){var a=getCheckedSearchType();e?goSearchResult(e,a):alert("请先选择下拉结果再点击搜索按钮")});var i=new function(t){function i(a){s.val(a.text()),e=a.attr("data-id"),c()}var s=n,l=$("#searchsSuggest"),o="",c=function(){l.html("").hide()},d=function(a){if("block"==l.css("display")&&38==a.keyCode||40==a.keyCode||13==a.keyCode){var r=l.find("li.hover");if(38==a.keyCode)if(r.length>0){var n=r.removeClass("hover").prev();if(n.length>0){n.addClass("hover");var c=n.find("span").text(),d=n.text().replace(c,"");s.val(d)}}else{var h=l.find("li:last");h.addClass("hover");var c=h.find("span").text(),d=h.text().replace(c,"");s.val(d)}else if(40==a.keyCode)if(r.length>0){var v=r.removeClass("hover").next();if(v.length>0){v.addClass("hover");var c=v.find("span").text(),d=v.text().replace(c,"");s.val(d)}}else{var u=l.find("li:first");u.addClass("hover");var c=u.find("span").text(),d=u.text().replace(c,"");s.val(d)}else 13==a.keyCode&&i(r)}else{var f=$.trim(s.val());if(""==f||f==o)return;t(f),o=f,e=null}};this.dataDisplay=function(e){var a=e.result;a.length<=0?c():(l.html(template("tplPreSearch",{keyword:o,result:a})),l.show(),l.find("li").hover(function(){l.find("li").removeClass("hover"),$(this).addClass("hover")},function(){$(this).removeClass("hover")}).bind("click",function(){i($(this))}))},s.bind("keyup",d),l.on(a,function(e){e.stopPropagation()}),r.on(a,function(){c()})}(function(e){t({url:URLS.URL_SEARCH_PRE_SEARCH,data:{key:e,type:getCheckedSearchType()},suppressNetErr:!0,success:function(e){var a=e.code,t=e.data;0==a&&t&&i.dataDisplay(t)}})})}),$(function(){var e="click",a={OVERVIEW_FAMILY:"overview_family",HELPER:"helper",FAMILY_IMPLEMENT:"family_implement",COUNTRY_STATUS:"country_status",COUNTRY_LEADER:"country_leader",COUNTRY_IMPLEMENT:"country_implement"},t=$.extend,r=Helpers.ajax,n=Helpers.getSearchObject,i=$.poorFile,s=i.FAMILY_TARGETS,l=i.COUNTRY_TARGETS,o=$("#searchResult");!function(){var c=n(),d=c.id,h=c.type;$(".search-types").find("[value="+h+"]").prop("checked",!0),function(e,a){showLoadingMask(),r({url:URLS.URL_SEARCH_SEARCH,data:{id:e,type:a},success:function(e){var a=e.code,r=e.data;0==a&&r&&($("#searchField").val(r.search_word),o.html(template("tplSearchResult",t(r,{SEARCH_TYPES:SEARCH_TYPES}))))},complete:function(){hideLoadingMask()},error:function(){}})}(d,h),o.on(e,"li",function(){var e=$(this),t=e.attr("data-key"),r=e.attr("data-id"),n=e.hasClass("no-link");switch(t){case a.OVERVIEW_FAMILY:i.showFamilyFile(r);break;case a.HELPER:i.showFamilyFile(r,s.NEWS);break;case a.FAMILY_IMPLEMENT:i.showFamilyFile(r,s.IMPLEMENT);break;case a.COUNTRY_STATUS:n||i.showCountryFile(r);break;case a.COUNTRY_LEADER:i.showCountryFile(r,l.NEWS);break;case a.COUNTRY_IMPLEMENT:i.showCountryFile(r,l.IMPLEMENT)}})}()});